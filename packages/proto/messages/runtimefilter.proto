syntax = "proto3";
option go_package = "./proto";
package runtimefilter;

service RuntimeFilterService {
  rpc Start(StartRequest) returns (StartResponse) {}
  rpc GetResult(GetResultRequest) returns (GetResultResponse) {}
  rpc SubResult(SubResultRequest) returns (GetResultResponse) {}
}

message StartRequest {
  string url = 1;
  string os = 2;
}

message StartResponse {
  string id = 1;
}

message GetResultRequest {
  string id = 1;
}

message GetResultResponse {
  string id = 1;
  string url = 2;
  bool malicious = 3;
}

message SubResultRequest  {
  string id = 1;
  optional int32 timeout = 2;
}